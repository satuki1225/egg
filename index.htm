<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>„Ç§„Éº„Çπ„Çø„Éº„Çø„Ç§„É†„Ç¢„Çø„ÉÉ„ÇØ</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      background: #fdf6e3;
      margin: 0;
      padding: 20px;
    }
    #gameArea {
      position: relative;
      width: 90%;
      max-width: 400px;
      height: 500px;
      margin: 0 auto;
      border: 3px solid #ccc;
      background-image: url("grass.png");
      background-size: cover;
      background-position: center;
      overflow: hidden;
      border-radius: 10px;
    }
    .egg-img {
      position: absolute;
      width: 60px;
      height: 60px;
      cursor: pointer;
      user-select: none;
      transition: transform 0.1s;
    }
    .egg-img:active {
      transform: scale(1.3);
    }
    #score {
      font-size: 24px;
      margin: 10px;
    }
    #startBtn {
      font-size: 20px;
      padding: 10px 20px;
      margin-top: 10px;
    }
    .note {
      font-size: 12px;
      color: #666;
      margin: 8px 0;
      line-height: 1.4;
    }
    @media (max-width: 480px) {
      .egg-img {
        width: 50px;
        height: 50px;
      }
      .note {
        font-size: 11px;
      }
    }
  </style>
</head>
<body>

  <h1>„Ç§„Éº„Çπ„Çø„Éº„Çø„Ç§„É†„Ç¢„Çø„ÉÉ„ÇØü•ö</h1>
  <p class="note">
    Ëµ§„ÅÑÂçµ„Çí„Ç≤„ÉÉ„Éà„Åó„Çà„ÅÜ<br>
    Èùí„ÅÑ„ÅÆ„ÅØ„Ç´„ÉÉ„Éó„Ç±„Éº„Ç≠„Å†„Çà<br>
    ‚ÄªÈü≥„ÅåÈ≥¥„Çä„Åæ„Åô
  </p>

  <div id="score">„Çπ„Ç≥„Ç¢Ôºö0</div>
  <button id="startBtn">„Ç≤„Éº„É†„Çπ„Çø„Éº„ÉàÔºÅ</button>
  <div id="gameArea"></div>

  <audio id="bgm" src="bgm.mp3" loop></audio>
  <audio id="se" src="se.mp3"></audio>

  <script>
    const gameArea = document.getElementById("gameArea");
    const scoreDisplay = document.getElementById("score");
    const startBtn = document.getElementById("startBtn");
    const bgm = document.getElementById("bgm");
    const se = document.getElementById("se");

    let score, elapsedTime, gameTimer, spawnLoop;
    const totalTime = 30;

    function getRandomPosition() {
      return {
        x: Math.random() * (gameArea.clientWidth - 60),
        y: Math.random() * (gameArea.clientHeight - 60)
      };
    }

    function spawnEggs(count) {
      for (let i = 0; i < count; i++) {
        const img = document.createElement("img");
        img.className = "egg-img";

        const isBomb = Math.random() < 0.2;
        img.src = isBomb ? "bomb.png" : "egg.png";
        img.dataset.bomb = isBomb;

        const { x, y } = getRandomPosition();
        img.style.left = x + "px";
        img.style.top  = y + "px";

        img.addEventListener("click", () => {
          if (img.dataset.bomb === "true") {
            score--;
            scoreDisplay.textContent = `„Çπ„Ç≥„Ç¢Ôºö${score}`;
            img.src = "explosion.png";
          } else {
            score++;
            scoreDisplay.textContent = `„Çπ„Ç≥„Ç¢Ôºö${score}`;
            se.currentTime = 0;
            se.play();
            img.src = "bunny.png";
          }
          img.style.pointerEvents = "none";
          setTimeout(() => img.remove(), 300);
        });

        gameArea.appendChild(img);
        setTimeout(() => {
          if (gameArea.contains(img)) img.remove();
        }, 1000);
      }
    }

    function spawnController() {
      clearTimeout(spawnLoop);
      if (elapsedTime >= totalTime) return;

      let interval = 1000;
      let count = 1;
      if (elapsedTime >= 20) {
        interval = 200;
        count = 2;
      } else if (elapsedTime >= 10) {
        interval = 500;
        count = 1;
      }

      spawnEggs(count);
      spawnLoop = setTimeout(spawnController, interval);
    }

    function startGame() {
      score = 0;
      elapsedTime = 0;
      scoreDisplay.textContent = "„Çπ„Ç≥„Ç¢Ôºö0";
      startBtn.disabled = true;
      gameArea.innerHTML = "";
      bgm.play();

      spawnController();
      gameTimer = setInterval(() => {
        elapsedTime++;
        if (elapsedTime >= totalTime) {
          clearInterval(gameTimer);
          clearTimeout(spawnLoop);
          endGame();
        }
      }, 1000);
    }

    function endGame() {
      bgm.pause();
      bgm.currentTime = 0;
      startBtn.disabled = false;
      gameArea.innerHTML = "";

      let comment = "üê∞„ÅÜ„Éº„Çì„ÄÅ„ÇÇ„Å£„Å®„Åå„Çì„Å∞„ÇçÔºü";
      if (score >= 30) comment = "üê∞‰ºùË™¨Á¥ö„ÅÆ„Éè„É≥„Çø„Éº„Åò„ÇÉ„ÇìÔºÅ";
      else if (score >= 20) comment = "üê∞„Åä„ÅâÔΩû„ÇÑ„Çã„Åò„ÇÉ„Å™„ÅÑ„ÅãÔºÅ";
      else if (score >= 10) comment = "üê∞„Åæ„ÅÇ„Åæ„ÅÇ„Å†„Å™ÔºÅ";
      else if (score >= 5)  comment = "üê∞ÊúÄÂàù„Å´„Åó„Å¶„ÅØÊÇ™„Åè„Å™„ÅÑÔºÅ";

      alert(`„Ç≤„Éº„É†ÁµÇ‰∫ÜÔºÅ\n„Çπ„Ç≥„Ç¢Ôºö${score}\n${comment}`);
    }

    startBtn.addEventListener("click", startGame);
  </script>

</body>
</html>
